% Base de dados dos pokemons de Kanto
% FORMATO: pokemon(nome,tipo_1,tipo_2,ataque,defesa,HP)

pokemon(bulbasaur,grama,veneno,49,49,45).
pokemon(ivysaur,grama,veneno,62,63,60).
pokemon(venusaur,grama,veneno,82,83,80).
pokemon(charmander,fogo,fogo,52,43,39).
pokemon(charmeleon,fogo,fogo,64,58,58).
pokemon(charizard,fogo,voador,84,78,78).
pokemon(squirtle,agua,agua,48,65,44).
pokemon(wartortle,agua,agua,63,80,59).
pokemon(blastoise,agua,agua,83,100,79).
pokemon(caterpie,inseto,inseto,30,35,45).
pokemon(metapod,inseto,inseto,20,55,50).
pokemon(butterfree,inseto,voador,45,50,60).
pokemon(weedle,inseto,veneno,35,30,40).
pokemon(kakuna,inseto,veneno,25,50,45).
pokemon(beedrill,inseto,veneno,90,40,65).
pokemon(pidgey,normal,voador,45,40,40).
pokemon(pidgeotto,normal,voador,60,55,63).
pokemon(pidgeot,normal,voador,80,75,83).
pokemon(rattata,normal,normal,56,35,30).
pokemon(raticate,normal,normal,81,60,55).
pokemon(spearow,normal,voador,60,30,40).
pokemon(fearow,normal,voador,90,65,65).
pokemon(ekans,veneno,veneno,60,44,35).
pokemon(arbok,veneno,veneno,85,69,60).
pokemon(pikachu,eletrico,eletrico,55,40,35).
pokemon(raichu,eletrico,eletrico,90,55,60).
pokemon(sandshrew,terra,terra,75,85,50).
pokemon(sandslash,terra,terra,100,110,75).
pokemon(nidoranF,veneno,veneno,47,52,55).
pokemon(nidorina,veneno,veneno,62,67,70).
pokemon(nidoqueen,veneno,terra,82,87,90).
pokemon(nidoranM,veneno,veneno,57,40,46).
pokemon(nidorino,veneno,veneno,72,57,61).
pokemon(nidoking,veneno,terra,92,77,81).
pokemon(clefairy,fada,fada,45,48,70).
pokemon(clefable,fada,fada,70,73,95).
pokemon(vulpix,fogo,fogo,41,40,38).
pokemon(ninetales,fogo,fogo,76,75,73).
pokemon(jigglypuff,normal,fada,45,20,115).
pokemon(wigglytuff,normal,fada,70,45,140).
pokemon(zubat,veneno,veneno,45,35,40).
pokemon(golbat,veneno,veneno,80,70,75).
pokemon(oddish,grama,veneno,50,55,45).
pokemon(gloom,grama,veneno,65,70,60).
pokemon(vileplume,grama,veneno,80,85,75).
pokemon(paras,inseto,grama,70,55,35).
pokemon(parasect,inseto,grama,95,80,60).
pokemon(venonat,inseto,veneno,55,50,60).
pokemon(venomoth,inseto,veneno,65,60,70).
pokemon(diglett,terra,terra,55,25,10).
pokemon(dugtrio,terra,terra,80,50,35).
pokemon(meowth,normal,normal,45,35,40).
pokemon(persian,normal,normal,70,60,65).
pokemon(psyduck,agua,agua,52,48,50).
pokemon(golduck,agua,agua,82,78,80).
pokemon(mankey,lutador,lutador,80,35,40).
pokemon(primeape,lutador,lutador,105,60,65).
pokemon(growlithe,fogo,fogo,70,45,55).
pokemon(arcanine,fogo,fogo,110,80,90).
pokemon(poliwag,agua,agua,50,40,40).
pokemon(poliwhirl,agua,agua,65,65,65).
pokemon(poliwrath,agua,lutador,85,95,90).
pokemon(abra,psiquico,psquico,20,15,25).
pokemon(kadabra,psiquico,psiquico,35,30,40).
pokemon(alakazam,psiquico,psiquico,50,45,55).
pokemon(machop,lutador,lutador,80,50,70).
pokemon(machoke,lutador,lutador,100,70,80).
pokemon(machamp,lutador,lutador,130,80,90).
pokemon(bellsprout,grama,veneno,75,35,50).
pokemon(weepinbell,grama,veneno,90,50,65).
pokemon(victreebel,grama,veneno,105,65,80).
pokemon(tentacool,agua,veneno,40,35,40).
pokemon(tentacruel,agua,veneno,70,65,80).
pokemon(geodude,pedra,terra,80,100,40).
pokemon(graveler,pedra,terra,95,115,55).
pokemon(golem,pedra,terra,120,130,80).
pokemon(ponyta,fogo,fogo,85,55,50).
pokemon(rapidash,fogo,fogo,100,70,65).
pokemon(slowpoke,agua,psiquico,65,65,90).
pokemon(slowbro,agua,psiquico,75,110,95).
pokemon(magnemite,eletrico,aco,35,70,25).
pokemon(magneton,eletrico,aco,60,95,50).
pokemon(farfetchd,normal,voador,65,55,52).
pokemon(doduo,normal,voador,85,45,35).
pokemon(dodrio,normal,voador,110,70,60).
pokemon(seel,agua,agua,45,55,65).
pokemon(dewgong,agua,gelo,70,80,90).
pokemon(grimer,veneno,veneno,80,50,80).
pokemon(muk,veneno,veneno,105,75,105).
pokemon(shellder,agua,agua,65,100,30).
pokemon(cloyster,agua,gelo,95,180,50).
pokemon(gastly,fantasma,veneno,35,30,30).
pokemon(haunter,fantasma,veneno,50,45,45).
pokemon(gengar,fantasma,veneno,65,60,60).
pokemon(onix,pedra,terra,45,160,35).
pokemon(drowzee,psiquico,psiquico,48,45,60).
pokemon(hypno,psiquico,psiquico,73,70,85).
pokemon(krabby,agua,agua,105,90,30).
pokemon(kingler,agua,agua,130,115,55).
pokemon(voltorb,eletrico,eletrico,30,50,40).
pokemon(electrode,eletrico,eletrico,50,70,60).
pokemon(exeggcute,grama,psiquico,40,80,60).
pokemon(exeggutor,grama,psiquico,95,85,95).
pokemon(cubone,terra,terra,50,95,50).
pokemon(marowak,terra,terra,80,110,60).
pokemon(hitmonlee,lutador,lutador,120,53,50).
pokemon(hitmonchan,lutador,lutador,105,79,50).
pokemon(lickitung,normal,normal,55,75,90).
pokemon(koffing,veneno,veneno,65,95,40).
pokemon(weezing,veneno,veneno,90,120,65).
pokemon(rhyhorn,terra,pedra,85,95,80).
pokemon(rhydon,terra,pedra,130,120,105).
pokemon(chansey,normal,normal,5,5,250).
pokemon(tangela,grama,grama,55,115,65).
pokemon(kangaskhan,normal,normal,95,80,105).
pokemon(horsea,agua,agua,40,70,30).
pokemon(seadra,agua,agua,65,95,55).
pokemon(goldeen,agua,agua,67,60,45).
pokemon(seaking,agua,agua,92,65,80).
pokemon(staryu,agua,agua,45,55,30).
pokemon(starmie,agua,psiquico,75,85,60).
pokemon(mrmime,psiquico,fada,45,65,40).
pokemon(scyther,inseto,voador,110,80,70).
pokemon(jynx,gelo,psíquico,50,35,65).
pokemon(electabuzz,eletrico,eletrico,83,57,65).
pokemon(magmar,fogo,fogo,95,57,65).
pokemon(pinsir,inseto,inseto,125,100,65).
pokemon(tauros,normal,normal,100,95,75).
pokemon(magikarp,agua,agua,10,55,20).
pokemon(gyarados,agua,voador,125,79,95).
pokemon(lapras,agua,gelo,85,80,130).
pokemon(ditto,normal,normal,48,48,48).
pokemon(eevee,normal,normal,55,50,55).
pokemon(vaporeon,agua,agua,65,60,130).
pokemon(jolteon,eletrico,eletrico,65,60,65).
pokemon(flareon,fogo,fogo,130,60,65).
pokemon(porygon,normal,normal,60,70,65).
pokemon(omanyte,pedra,agua,40,100,35).
pokemon(omastar,pedra,agua,60,125,70).
pokemon(kabuto,pedra,agua,80,90,30).
pokemon(kabutops,pedra,agua,115,105,60).
pokemon(aerodactyl,pedra,voador,105,65,80).
pokemon(snorlax,normal,normal,110,65,160).
pokemon(articuno,gelo,voador,85,100,90).
pokemon(zapdos,eletrico,voador,90,85,90).
pokemon(moltres,fogo,voador,100,90,90).
pokemon(dratini,dragao,dragao,64,45,41).
pokemon(dragonair,dragao,dragao,84,65,61).
pokemon(dragonite,dragao,voador,134,95,91).
pokemon(mewtwo,psiquico,psiquico,110,90,106).
pokemon(mew,psiquico,psiquico,100,100,100).


% Base de dados com cada tipo e suas vantagens e desvatagens sobre outros tipo
% FORMATO: tipo(nome_tipo, possui_vantagem, possui_desvantagem)

tipo(grama, [agua, terra, pedra], [fogo, veneno, inseto, voador, gelo]).
tipo(fogo, [grama, inseto, gelo], [agua, terra, pedra]).
tipo(agua, [fogo, terra, pedra], [grama, eletrico]).
tipo(eletrico, [agua, voador], [eletrico, grama]).
tipo(terra, [fogo, veneno, pedra, eletrico, aco], [agua, grama, gelo]).
tipo(voador, [grama, inseto, lutador], [eletrico, gelo, pedra]).
tipo(inseto, [grama, psiquico], [fogo, voador, pedra]).
tipo(gelo, [grama, terra, voador, dragao], [fogo, agua, gelo, aco]).
tipo(lutador, [normal, pedra, gelo, aco], [voador, psiquico, fada]).
tipo(normal, [], [lutador]).
tipo(veneno, [grama, fada], [terra, psiquico]).
tipo(psiquico, [lutador, veneno], [inseto, fantasma, sombrio]).
tipo(pedra, [fogo, gelo, voador, inseto], [agua, grama, lutador, terra, aco]).
tipo(fantasma, [fantasma, psiquico], [fantasma, sombrio]).
tipo(aco, [gelo, pedra, fada], [fogo, lutador, terra]).
tipo(dragao, [dragao], [gelo, fada, dragao]).
tipo(fada, [lutador, dragao, sombrio], [veneno, aco]).


% Predicado para verificar vantagem do tipo A sobre o tipo B

tem_vantagem(A, B) :-
    tipo(A, Vantagens, _),
    member(B, Vantagens).


% Predicado para calcular o dano baseado na vantagem do tipo do pokemon

calcular_dano(Atacante, Defensor, Dano) :-
    pokemon(Atacante, Tipo1A, Tipo2A, AtaqueA, _, _),
    pokemon(Defensor, Tipo1D, Tipo2D, _, DefesaD, _),
    (tem_vantagem(Tipo1A, Tipo1D) -> Mult1 is 2; Mult1 is 1),
    (tem_vantagem(Tipo1A, Tipo2D) -> Mult2 is 2; Mult2 is 1),
    (tem_vantagem(Tipo2A, Tipo1D) -> Mult3 is 2; Mult3 is 1),
    (tem_vantagem(Tipo2A, Tipo2D) -> Mult4 is 2; Mult4 is 1),
    MultFinal is Mult1 * Mult2 * Mult3 * Mult4,
    DanoBruto is (AtaqueA - DefesaD),
    (DanoBruto < 1 -> DanoCorrigido is 1; DanoCorrigido is DanoBruto),% Corrige dano minimo
    Dano is DanoCorrigido * MultFinal + 10.


% Predicado para determinar o vencedor baseado no dano calculado

determinar_vencedor(Pokemon1, Pokemon2, Vencedor) :-
    calcular_dano(Pokemon1, Pokemon2, Dano1),
    calcular_dano(Pokemon2, Pokemon1, Dano2),
    (Dano1 > Dano2 -> Vencedor = Pokemon1;
     Dano2 > Dano1 -> Vencedor = Pokemon2;
     Dano1 == Dano2 -> Vencedor = empate).


% Predicado para contar e listar todos os pokemons que são derrotados por um pokemon X

listar_e_contar_vitorias(Pokemon) :-
    findall(Vencido, (pokemon(Vencido, _, _, _, _, _), determinar_vencedor(Pokemon, Vencido, Pokemon)), Vencidos),
    length(Vencidos, Count),
    listar_e_contar(Vencidos),
    format('Total de Pokémons que são derrotados por ~w: ~d~n', [Pokemon, Count]).


% Predicado para contar e listar todos os pokemons que derrotam um pokemon X

listar_e_contar_derrotas(Pokemon) :-
    findall(Vencedor, (pokemon(Vencedor, _, _, _, _, _), determinar_vencedor(Vencedor, Pokemon, Vencedor)), Vencedores),
    length(Vencedores, Count),
    listar_e_contar(Vencedores),
    format('Total de Pokémons que derrotam ~w: ~d~n', [Pokemon, Count]).


% Predicado para contar e listar todos os pokemons que empatam com um pokemon X

listar_e_contar_empates(Pokemon) :-
    findall(Empate, (pokemon(Empate, _, _, _, _, _), determinar_vencedor(Pokemon, Empate, empate)), Empates),
    length(Empates, Count),
    listar_e_contar(Empates),
    format('Total de Pokémons que empatam com ~w: ~d~n', [Pokemon, Count]).


% Predicado auxiliar para criar a lista e a contagem
listar_e_contar([]).
listar_e_contar([Head|Tail]) :-
    writeln(Head),
    listar_e_contar(Tail).



% Exemplos de consultas:

% Para saber o resultado de uma batalha entre um pokemon X e um pokemonY:
% ?- determinar_vencedor(nome_pokemon1, nome_pokemon2, Vencedor).

% Para saber todos os pokemons que seriam derrotados por um pokemon X:
% ?- listar_e_contar_vitorias(nome_pokemon).

% Para saber todos os pokemons que derrotariam um pokemon X:
% ?- listar_e_contar_derrotas(nome_pokemon).

% Para saber todos os pokemons que empatariam com um pokemon X:
% ?- listar_e_contar_empater(nome_pokemon).

